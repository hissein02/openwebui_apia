services:
  apia:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - USE_OLLAMA=false
    image: ${DOCKER_IMAGE_NAME:-apia}:${DOCKER_IMAGE_TAG:-latest}
    container_name: apia
    volumes:
      - apia-data:/app/backend/data
    ports:
      - ${WEBUI_PORT:-3000}:8080
    environment:
      # Required: Set your remote Ollama server URL
      - OLLAMA_BASE_URL=${OLLAMA_BASE_URL:-http://host.docker.internal:11434}
      # App name (customize as needed)
      - WEBUI_NAME=${WEBUI_NAME:-APIA}
      # Security
      - WEBUI_SECRET_KEY=${WEBUI_SECRET_KEY:-}
      # Disable telemetry
      - SCARF_NO_ANALYTICS=true
      - DO_NOT_TRACK=true
      - ANONYMIZED_TELEMETRY=false
    extra_hosts:
      - host.docker.internal:host-gateway
    restart: unless-stopped

volumes:
  apia-data: {}
